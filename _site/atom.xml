<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
   <title>ningg.top</title>
   <link href="http://ningg.top" rel="self" type="application/atom+xml"/>
   <link href="http://ningg.top" rel="alternate" type="text/html" />
   <updated>2015-05-27T00:42:19+08:00</updated>
   <id>http://ningg.top</id>
   <author>
     <name></name>
     <email></email>
   </author>

   
   <entry>
     <title>JS实现全屏滚动</title>
     <link href="http://ningg.github.com/js-full-page"/>
     <updated>2015-05-26T00:00:00+08:00</updated>
     <id>http://ningg.github.com/js-full-page</id>
     <content type="html">&lt;h2 id=&quot;section&quot;&gt;示例效果&lt;/h2&gt;

&lt;p&gt;示例效果如下：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.qiniu.com/&quot;&gt;青牛-MainPage&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.mi.com/shouhuan/#02&quot;&gt;小米手环-MainPage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;jquery&quot;&gt;jQuery全屏滚动插件详解&lt;/h2&gt;

&lt;p&gt;几点：&lt;/p&gt;

&lt;p&gt;在线演示以及详细介绍：&lt;a href=&quot;http://www.dowebok.com/77.html&quot;&gt;jQuery全屏滚动插件fullPage.js&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;todo：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;添加GitHub上工程&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-1&quot;&gt;参考来源&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/alvarotrigo/fullPage.js&quot;&gt;fullPage.js(GitHub)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.dowebok.com/77.html&quot;&gt;jQuery全屏滚动插件fullPage.js&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.qiniu.com/&quot;&gt;青牛-MainPage&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.mi.com/shouhuan/#02&quot;&gt;小米手环-MainPage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>Be Kind</title>
     <link href="http://ningg.github.com/be-kind"/>
     <updated>2015-05-15T00:00:00+08:00</updated>
     <id>http://ningg.github.com/be-kind</id>
     <content type="html">&lt;blockquote&gt;
  &lt;p&gt;原文地址：&lt;a href=&quot;http://boz.com/articles/be-kind.html&quot;&gt;Be Kind&lt;/a&gt;，是不是工作中有一些人，技术强、辩才佳、充满正义感、一心为公家、都得按他的意思做事而且他道理都是对的你辩不过他，但大家都不喜欢跟他共事？Facebook早期员工Boz曾经是这样的人，看看他以过来人身份怎么说的。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;section&quot;&gt;原文&lt;/h2&gt;

&lt;p&gt;I almost got fired once.&lt;/p&gt;

&lt;p&gt;My friend, and CTO at the time, Dustin Moskovitz pulled me into a room one morning. He told me I would no longer be working on News Feed, which was surprising because at the time I was the only engineer keeping it running. Instead they were going to hand it off to someone else and build a team around that person. With alarm in my voice I asked if I was being fired. Dustin relented only after a telling pause: “no, but you need to find something else to do.”&lt;/p&gt;

&lt;p&gt;I believe if you looked at what I had accomplished in my two years at Facebook to that point, it would not be obvious that I should be a candidate for such a stern conversation. In addition to building the backend and ranking for News Feed I had also launched a number of other popular features on the site. I maintained our early anti-abuse efforts in my spare time. I was one of a small group of people making decisions that would shape our infrastructure for years to come. I wasn’t the best engineer at the company but I was solid, I was dedicated, and I was clearly having an impact.&lt;/p&gt;

&lt;p&gt;So why was I being sidelined? I demanded answers. Dustin did not disappoint.&lt;/p&gt;

&lt;p&gt;He gave me a single sheet of paper. On it, in a dull monospace font, were anonymous quotes about me from my coworkers.&lt;/p&gt;

&lt;p&gt;“Boz is one of the better engineers at Facebook” one read, and then the next “I would have a hard time working with him.”&lt;/p&gt;

&lt;p&gt;These two statements struck me as incongruous. If I was a good engineer, why would it be hard to work with me? Of course that question was the very foundation of my problem.&lt;/p&gt;

&lt;p&gt;“He is most interested in the truth…but more inhibited members of the team avoid any discussions with him.”&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：团队内部，真理（真相）重要，但不要一味地追求真理（真相），特别留意围绕什么是真理（真相）讨论来讨论去，通常，这不是团队的首要目标，还会破坏团队内部氛围，首要目标是什么？做既定的有意义、有价值的工作，有计划的完成。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The realization hit me hard. In short, I thought my job was to be right. I thought that was how I proved my worth to the company. But that was all wrong. &lt;strong&gt;My job was to get things done and doing anything meaningful past a certain point requires more than one person&lt;/strong&gt;. If you are right but nobody wants to work with you, then how valuable are you really? How much can you realistically expect to accomplish on your own? I was “winning” my way out of a job one argument at a time.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：一个人终难成事，需要一个队伍，队伍内部首要的是团结一心做事情，大家和谐相处，把事情做成，而不是证明谁正确、谁聪明。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I headed home early that day to think about what I had heard. My future wife April was gentle but she offered me little reprieve from the feedback: “&lt;strong&gt;If you want people to work with you, you need to be kind.&lt;/strong&gt;” It turns out this wasn’t just a problem I had at work. Looking back, I’m amazed (and grateful) that my friends put up with me.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：个人的行为动作，通常不仅仅表现在工作中，生活中也是如此，一起做事情，be kind。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Altogether this feedback changed the course of my career and probably my life.&lt;/p&gt;

&lt;p&gt;I don’t think I was ever outright mean to anyone. I was just callously indifferent and on a long enough timeline that is indistinguishable from being mean. In a cruel twist of irony I thought that was what it meant to be professional. In retrospect it just seems inhuman. It will take me several posts to details the many mistakes that got me to this point, but my biggest lesson was the importance of kindness.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：总认为自己与众不同，不知道自己对待他人过于刻薄，反倒自认为是专业，而实际上，自己的做法堪称不人道。这件事，收获最大的一点是：Kind，善意地去理解、善意地对待。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Being kind isn’t the same as being nice. It isn’t about superficial praise. It doesn’t mean dulling your opinions. And it shouldn’t diminish the passion with which you present them.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：善意，与待人和蔼不同，不是肤浅的赞美；也不是要求，弱化自己的见解；也不是，让自己的激情消减。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Being kind is fundamentally about taking responsibility for your impact on the people around you. It requires you be mindful of their feelings and considerate of the way your presence affects them.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：善意，是为你对周围人的影响负责。你需要体会他们的感受，以及你的行为对他们的影响。因为，团队要一起前进，才能走的更扎实、更稳妥。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Being kind hasn’t hurt my effectiveness at all. Being thoughtful about the emotions of my colleagues hasn’t made me any less right or wrong, it has simply made me more likely to be asked to help in the first place. Being invited to more conversations has allowed me to scale my impact in a way that would have been unfathomable on my own.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：真正的善意，并不会影响工作的效率和产出；理解和照顾他人的感受，也不会影响自己的观点，反倒会让团队更加团结。多参加交流、讨论，找到自己善意的那个点。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;I’m still not as good as I’d like to be at any of this. When I’m under stress I can sometimes fall back into my old habits. But believing deeply that I am responsible for how I make others feel has been life changing for me. Being kind turns out to be a long term strategy for maximizing impact.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes(ningg)：压力大的时候，就会随心所欲的发表自己的意见；在内心深处，为自己对他人的影响负责，会帮助自己。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;section-1&quot;&gt;个人成长&lt;/h2&gt;

&lt;p&gt;在这个时间，看到这篇自述，让我很触动，反思自己，我在这方面问题很多、很大，下面才是可取的态度：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;为自己对他人的影响负责&lt;/li&gt;
  &lt;li&gt;善意理解&lt;/li&gt;
  &lt;li&gt;善意对待&lt;/li&gt;
  &lt;li&gt;理解他人的感受，照顾他人的感受，这是长期策略&lt;/li&gt;
  &lt;li&gt;自己有观点，交流、表述过程中要主意方式，避免带着情绪说话&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-2&quot;&gt;参考来源&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://boz.com/articles/be-kind.html&quot;&gt;Be Kind&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://wanqu.co/2015-05-15-be-kind.html&quot;&gt;Be Kind - 湾区日报&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>中国未来5~10年的社会发展趋势</title>
     <link href="http://ningg.github.com/china-next-5-years-from-2015"/>
     <updated>2015-05-09T00:00:00+08:00</updated>
     <id>http://ningg.github.com/china-next-5-years-from-2015</id>
     <content type="html">&lt;h2 id=&quot;section&quot;&gt;整体原则&lt;/h2&gt;

&lt;p&gt;未来几年的整体原则：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;工资涨幅慢：工资涨幅低于生产效率提升&lt;/li&gt;
  &lt;li&gt;劳动生产效率快速提升：向高效率靠拢，提升人力效率，先进科技释放劳动力
    &lt;ul&gt;
      &lt;li&gt;技术水平&lt;/li&gt;
      &lt;li&gt;经营管理&lt;/li&gt;
      &lt;li&gt;熟练程度&lt;/li&gt;
      &lt;li&gt;生产要素流动&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;税负加重（逐步提高，用于再分配）&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-1&quot;&gt;具体操作&lt;/h2&gt;

&lt;p&gt;为实现上述原则，进行如下操作：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;人力资本提升：能力、效率方面&lt;/li&gt;
  &lt;li&gt;灵活的劳动力市场：科技释放劳动力，促进人员流动，通常由市场繁荣主动引导&lt;/li&gt;
  &lt;li&gt;要素流动和交易：特别是土地，要素在不同人手中，价值不同，要提升要素使用效率&lt;/li&gt;
  &lt;li&gt;开放的经济环境：面向全球市场&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-2&quot;&gt;伴随现象&lt;/h2&gt;

&lt;p&gt;潜在的几个典型现象：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;民粹主义：普通大众认为精英阶层拿走了本应属于自己的报酬，他们内心希望从精英阶层拿回自己的报酬，实际上，类似的贫富差距是由政府鼓励高效率行业，哪些少数被鼓励的行业必然产生精英阶层，这是他们应得的，只有他们获得的更多，才能激发他们进一步的效率提升&lt;/li&gt;
  &lt;li&gt;社会浮躁：个性张扬、自由主义泛滥，野蛮与文明交织；&lt;em&gt;（年轻人不要熬夜，早点睡，实质是：引导普通人过普通的日子，而不是幻想个人英雄主义）&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;法治缺失：伴随行业调整，会产生新的现象，需要新的法律；&lt;em&gt;（全面依法治国）&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;腐败盛行：新的富裕阶层产生，新的法律灰暗地带&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-3&quot;&gt;所处历史时期&lt;/h2&gt;

&lt;p&gt;当前处于3期交汇，情况比较复杂：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;换档期：人口结构变化，引发经济增速换挡，GDP增速，预期从9~10%，转变为&amp;lt; 5%，在努力之下，将保证6.5~7%&lt;/li&gt;
  &lt;li&gt;消化期：对于高杠杆率的消化，避免集中爆发，因此要降下杠杆率
    &lt;ul&gt;
      &lt;li&gt;高杠杆率，有什么影响？为什么之前没事？&lt;/li&gt;
      &lt;li&gt;如何操作才能降低杠杆率？&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-4&quot;&gt;时间点&lt;/h2&gt;

&lt;p&gt;十八届三中、四中全会，确定了具体的改革任务，决定性任务都要在2020年完成：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;法制&lt;/li&gt;
  &lt;li&gt;生产要素的流转机制&lt;/li&gt;
  &lt;li&gt;生产效率的提升&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-5&quot;&gt;释放农业人口&lt;/h3&gt;

&lt;p&gt;目标：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;释放农业劳动力：刘易斯拐点已过，需要释放劳动力&lt;/li&gt;
  &lt;li&gt;合理利用土地&lt;/li&gt;
  &lt;li&gt;提高农业生产效率&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;具体操作：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;集中化经营&lt;/li&gt;
  &lt;li&gt;分散各类种养业，相对收益高&lt;/li&gt;
  &lt;li&gt;农业合作组织发展，帮助农民连接市场；&lt;em&gt;（新的供销社模式，辅助土地流转）&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-6&quot;&gt;合理的城镇化&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;哪些地方有工作机会？&lt;/strong&gt; 大城市、特大城市为中心的城市带，包含周围的小城镇才有就业机会，设计、物流、生活服务，以及围绕制造业的一些生产服务就业机会。未来中国也是这样，西部可能会围绕省会以及一两个重要城市，形成城市带。&lt;/p&gt;

&lt;h3 id=&quot;section-7&quot;&gt;房产税&lt;/h3&gt;

&lt;p&gt;目标：解决用地扭曲，城市人口密度整体降低，但拥挤集中，激励地方政府盘活存量。&lt;/p&gt;

&lt;h2 id=&quot;section-8&quot;&gt;小结&lt;/h2&gt;

&lt;p&gt;一句话：效率优先，工资其次。&lt;/p&gt;

</content>
   </entry>
   
   <entry>
     <title>青年时间 - 几个小事情</title>
     <link href="http://ningg.github.com/personal-think-20150509"/>
     <updated>2015-05-08T00:00:00+08:00</updated>
     <id>http://ningg.github.com/personal-think-20150509</id>
     <content type="html">&lt;p&gt;想一想自己已经青年了，在很小的时候，应该是小学一二年级，我就总想着长大了要如何如何：要像爸爸一样去很多地方&lt;em&gt;（实际我小时候，父亲也就是常往返市区）&lt;/em&gt;，要坐舒服的轿车…现在我真的长大了，这些曾经的想法，好像都是触手可及：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;我本科在长春读了4年书，硕士又在北京生活了3年，再后来就是上海生活了1年，这么说来，我小时候的第一个小愿望早已实现了；&lt;/li&gt;
  &lt;li&gt;截至2014年中国的汽车保有量达1.54亿量，虽然没有一辆属于自己的车，但这个小小的愿望也是触手可及；&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;上面两个小愿望，早已不像小时候那样对我有过多的吸引力，实际上，现在回想起来，小时候有这样那样的愿望，本质是：内心深处想追求美好的东西，追求那些自己没有的东西。现在还有愿望吗？有的 。我要有一份自己的事业，要让家人过上舒适的生活，要跟父母住在一起&lt;em&gt;（或者离得很近）&lt;/em&gt;。这几个愿望能实现吗？事实上，这几个是最最普通的愿望了。这些是奢侈品吗？是的，至少对当前的我来说是这样的。但这些并不是遥不可及的，只要顺应时势，结合自身特点，有方向、有步骤的去做，在30~33岁是有可能实现的。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;沮丧&lt;/h2&gt;

&lt;p&gt;有时候心情很低落，弄一个压箱底的小故事吧：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;光武帝刘秀打仗的时候，有一次吃了败仗，夜里去巡视营房，看看那些战败的士兵是什么心态。结果一看，这个帐篷里几个人，都是满脸眼泪，哭哭啼啼地写家书的、写情书的。跑到另一个帐篷里一看，几人喝的醉醺醺的，也是满脸的眼泪，抱在一块又唱又哭，丑态百出。走着走着，发现一路都是这样，终于，在走到一个帐篷，往里一看，里面坐着一个年轻的将军。他拿着一块破布，不停的擦自己的武器和盔甲，擦的雪亮雪亮。脸上的表情，既不忧伤，也不沮丧，也不亢奋，很平静，就坐在那里擦武器，擦得雪亮雪亮的，准备下一场战斗。刘秀很惊讶，说：“这小子肯定能成事。”后来这小子真的成了事，他就是东汉的大将军吴汉。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;面对困难的时候，不必伤心、不必难过、不必沮丧，甚至不要控诉、不要愤怒、不要抗议，埋头擦亮你的武器，准备下一次的战斗。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;section-1&quot;&gt;沟通&lt;/h2&gt;

&lt;p&gt;几个人一起做事情，目标是把事情做成。因此，应该注意沟通方式、避免随心所欲，本着将目标达成去向前推进。&lt;/p&gt;

&lt;p&gt;几点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;沟通时，&lt;strong&gt;逞一时意气&lt;/strong&gt;，不可取，对目标达成没有用处；&lt;/li&gt;
  &lt;li&gt;沟通时，取得结果、&lt;strong&gt;达成目标是第一位&lt;/strong&gt;的，言语可以&lt;strong&gt;委婉些&lt;/strong&gt;，避免带着情绪说话；&lt;/li&gt;
  &lt;li&gt;把握重点，对于他人犯得&lt;strong&gt;无关紧要的错误&lt;/strong&gt;，不必一定纠正；&lt;/li&gt;
  &lt;li&gt;说话，有重点、有条理、不带情绪、有些委婉；&lt;/li&gt;
  &lt;li&gt;提前有个基本方案，也要听听大家的意见和看法，全面的信息输入，就会更高概率得到完善的方案；&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-2&quot;&gt;团队协作&lt;/h2&gt;

&lt;p&gt;几点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;以善意去理解他人的意思&lt;/li&gt;
  &lt;li&gt;敬畏，天外有天&lt;/li&gt;
  &lt;li&gt;顺势而为：哪个地方好切入，而不是为了新鲜&lt;/li&gt;
  &lt;li&gt;做熟不做生，不懂的、不熟的，多学习、深究，多请教专家的意见&lt;/li&gt;
  &lt;li&gt;想得再好，动手做&lt;/li&gt;
  &lt;li&gt;多倾听他人说话，言之有物&lt;/li&gt;
  &lt;li&gt;对团队内部的工作进展，多进行反馈&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>51用车APP--新用户注册下载APP步骤</title>
     <link href="http://ningg.github.com/51yche-car-owner-zm-activity"/>
     <updated>2015-04-22T00:00:00+08:00</updated>
     <id>http://ningg.github.com/51yche-car-owner-zm-activity</id>
     <content type="html">&lt;blockquote&gt;
  &lt;p&gt;新用户下载安装APP，有两种方式：1. 下载APP–注册–使用APP；2. 注册–下载APP–安装APP。由于第2种方式，能以对用户影响较小的方式，与用户建立沟通途径，因此，相对更容易争取边缘用户。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;app&quot;&gt;51用车APP获取新用户步骤&lt;/h2&gt;

&lt;p&gt;今天下班路上，无意间看到51用车的宣传单：招募车主。浏览了一下，注册成为车主的步骤：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/51yche-car-owner-zm-activity/cowner-step.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;上面的图片中列出了6个步骤：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;扫描二维码，进入招募车主页面&lt;/li&gt;
  &lt;li&gt;在招募车主页面，点击“立即报名”按钮&lt;/li&gt;
  &lt;li&gt;阅读招募标准，并提交简单资料后，获得临时短信密码&lt;/li&gt;
  &lt;li&gt;下载APP客户端，选择以“我是车主”身份登录&lt;/li&gt;
  &lt;li&gt;登录后，进入车主版首页，点“发布路线”按钮，设置上下班线路&lt;/li&gt;
  &lt;li&gt;提交驾驶本、行驶证正面照片，客服审核通过后，即成为车主&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;上面步骤很详细，简单抽象一下：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;注册：不必下载APP，直接以手机号注册&lt;/li&gt;
  &lt;li&gt;下载APP：下载并安装到手机上&lt;/li&gt;
  &lt;li&gt;使用APP：下载APP后，提交资料，审核后，成为车主&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;app-1&quot;&gt;普通APP获取新用户步骤&lt;/h2&gt;

&lt;p&gt;回顾一下，自己之前用到的APP的普遍注册步骤：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;下载APP&lt;/li&gt;
  &lt;li&gt;注册：手机或者邮箱&lt;/li&gt;
  &lt;li&gt;使用APP&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;上面几个步骤中，有一个难点，怎么说服用户下载APP到手机上？当然用户下载APP，常见原因有：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;广告&lt;/strong&gt;，让用户体会到使用APP能够获得两点：
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;方便&lt;/strong&gt;：能够解决困扰自己的问题；&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;有利可图&lt;/strong&gt;：常见的优惠，送话费、送优惠券、送折扣；&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;朋友推荐&lt;/strong&gt;，朋友体会到上述两点：便利、有利可图之后，会向身边好友推荐，如果推荐的同时，自己还能获得二次优惠，那推荐的动力就更足了。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;特别说明：如果APP只能让用户体会到&lt;strong&gt;有利可图&lt;/strong&gt;
很大一部分人，占了便宜之后，很长时间不再使用APP，甚至删掉APP，当然，如果有持续的优惠，用户一般会持续的使用APP的，但这种持续，是无意义的。一个APP能够长久存在，必须为用户创造价值，具体几类：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;便利&lt;/strong&gt;：节省自己的时间，例如，大众点评APP上的排号功能，不到现场，就能排号，更合理的安排自己的时间；&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;有趣&lt;/strong&gt;：休闲时间，获得乐趣，例如：德州扑克，各种手游；&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;特别说明：微信、QQ是通讯类APP，便捷的与他人交流，归属&lt;strong&gt;便利&lt;/strong&gt;这一类。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;两种方式分析&lt;/h2&gt;

&lt;p&gt;上述两种方式，都包含：下载APP、注册、使用APP，共计3个步骤，差异在于顺序的不同，同时这几个步骤中，下载APP对用户的影响是最大的，因为要消耗流量、等待时间较长。下图将用一张图来形象对比上述的两种获取新用户的步骤。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/51yche-car-owner-zm-activity/51yche-vs-other.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;上图中，3个步骤：&lt;strong&gt;下载APP&lt;/strong&gt;、&lt;strong&gt;注册&lt;/strong&gt;、&lt;strong&gt;使用APP&lt;/strong&gt;；其中，&lt;strong&gt;下载APP&lt;/strong&gt;的图标最大，来标识其对用户的影响最大。&lt;/p&gt;

&lt;p&gt;简要分析两种方式的特点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;下载APP–注册–使用APP&lt;/strong&gt;，此方式特点：弱化注册过程，用户犹豫是否要安装APP的时间，都在&lt;strong&gt;下载APP&lt;/strong&gt;之前；在用户下载并安装APP之前，APP提供商与用户之间的沟通途径是没有的，即，APP提供商，无法触达用户；一旦用户下载APP的意愿不够强烈，同时又因为其他事情打断&lt;strong&gt;下载APP&lt;/strong&gt;，这就会丢失一个用户；此类用户称为边缘用户，是争取的重点，但没有途径触达他们，这是个遗憾；&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;注册–下载APP–使用APP&lt;/strong&gt;，此方式特点：缓冲&lt;strong&gt;下载APP&lt;/strong&gt;给用户的压力，对用户来说，注册给用户带来的相对较小，而且，这种方式，能够在用户犹豫的时候，获取与用户之间沟通的途径；有了这条途径，可以低成本的争取边缘用户。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;总上所述，针对使用APP意愿不强烈的边缘用户，采用&lt;strong&gt;注册–下载APP–使用APP&lt;/strong&gt;方式，更容易争取边缘用户。&lt;/p&gt;

</content>
   </entry>
   
   <entry>
     <title>Kafka 0.8.2.0 删除Topic</title>
     <link href="http://ningg.github.com/kafka-delete-topic"/>
     <updated>2015-04-01T00:00:00+08:00</updated>
     <id>http://ningg.github.com/kafka-delete-topic</id>
     <content type="html">&lt;p&gt;几点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;修改Kafka的配置文件，Kafka节点会自动生效吗？&lt;/li&gt;
  &lt;li&gt;逐个修改Kafka节点，并逐个重启Kafka节点，是否可以？&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;修改Kafka配置文件，增加可删除Topic的设置：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;delete.topic.enable=true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;然后，逐个重启Kafka节点，即可。逐个重启Kafka节点，而对其他系统没有影响，是因为之前已经设置每个数据备份两份：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# The default replication factor for automatically created topics.
default.replication.factor=2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;上述，开启可删除topic标识之后，可以删除Topic，操作如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bin/kafka-topics.sh --zookeeper zk_host:port/chroot --delete --topic my_topic_name
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;然后，通过如下命令可以查看topic状态：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ bin/kafka-topics.sh --zookeeper 168.7.2.165 --list
fdiy - marked for deletion
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;疑问：为什么topic：fdiy还存在？并且还被标记上&lt;code&gt;marked for deletion&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;（TODO）&lt;/p&gt;

&lt;p&gt;关于上述&lt;code&gt;marked for deletion&lt;/code&gt;的现象，当前并不能确定原因，todo&lt;/p&gt;

&lt;p&gt;参考来源：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/KAFKA/Kafka+Command+Line+and+Related+Improvements&quot;&gt;Kafka Command Line and Related Improvements&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://comments.gmane.org/gmane.comp.apache.kafka.user/6686&quot;&gt;Problem deleting topics in 0.8.2?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section&quot;&gt;参考来源&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://kafka.apache.org/documentation.html&quot;&gt;Kafka 0.8.2 Documentation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/16284399/purge-kafka-queue&quot;&gt;Purge Kafka Queue&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/17730905/is-there-a-way-to-delete-all-the-data-from-a-topic-or-delete-the-topic-before-ev&quot;&gt;Is there a way to delete all the data from a topic or delete the topic before every run?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>Kibana入门操作</title>
     <link href="http://ningg.github.com/kibana-intro"/>
     <updated>2015-03-16T00:00:00+08:00</updated>
     <id>http://ningg.github.com/kibana-intro</id>
     <content type="html">&lt;p&gt;当前使用组件的版本：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;组件&lt;/th&gt;
      &lt;th&gt;版本&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ElasticSearch&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.4.4&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Java&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.7.0_67&lt;/code&gt; HotSpot(64) 64-Bit&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Kibana&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;kibana-4.0.1-linux-x64&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;section&quot;&gt;启动&lt;/h2&gt;

&lt;p&gt;Kibana本质就是一个Web工程，启动命令：&lt;code&gt;bin/kibana&lt;/code&gt;，具体查看启动脚本，发现最终启动的是NodeJS相关的服务：&lt;code&gt;bin/../node/bin/node bin/../src/bin/kibana.js&lt;/code&gt;，NodeJS我不懂，具体没看明白。几个疑问：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;如何后台启动Kibana？
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;nohup bin/kibana &amp;amp;&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Kibana运行日志位置？&lt;/li&gt;
  &lt;li&gt;如何监控Kibana运行状态？&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>ElasticSearch入门操作</title>
     <link href="http://ningg.github.com/elasticsearch-intro"/>
     <updated>2015-03-12T00:00:00+08:00</updated>
     <id>http://ningg.github.com/elasticsearch-intro</id>
     <content type="html">&lt;p&gt;当前使用组件的版本：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;组件&lt;/th&gt;
      &lt;th&gt;版本&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ElasticSearch&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.4.4&lt;/code&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Java&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.7.0_67&lt;/code&gt; HotSpot(64) 64-Bit&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;section&quot;&gt;启动&lt;/h2&gt;

&lt;p&gt;直接下载，然后解压，直接运行脚本&lt;code&gt;bin/elasticsearch&lt;/code&gt;。如果希望 ElasticSearch 在后台运行，则执行命令&lt;code&gt;bin/elasticsearch -d&lt;/code&gt;，其将 ElasticSearch 进程的父进程设置为超级进程（&lt;code&gt;pid=1&lt;/code&gt;）。现在，如何测试是否启动成功？可向 &lt;code&gt;http://localhost:9200&lt;/code&gt; 发送一条请求，会查看到返回的JSON字符串，具体效果如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[ningg@localhost ~]$ curl -XGET http://localhost:9200/
{
  &quot;status&quot; : 200,
  &quot;name&quot; : &quot;Silly Seal&quot;,
  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,
  &quot;version&quot; : {
	&quot;number&quot; : &quot;1.4.4&quot;,
	&quot;build_hash&quot; : &quot;c88f77ffc81301dfa9dfd81ca2232f09588bd512&quot;,
	&quot;build_timestamp&quot; : &quot;2015-02-19T13:05:36Z&quot;,
	&quot;build_snapshot&quot; : false,
	&quot;lucene_version&quot; : &quot;4.10.3&quot;
  },
  &quot;tagline&quot; : &quot;You Know, for Search&quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;补充几点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;验证ElasticSearch是否成功启动，也可以直接使用浏览器，访问&lt;code&gt;http://localhost:9200&lt;/code&gt;，将此处 &lt;code&gt;localhost&lt;/code&gt; 替换为服务器的IP。&lt;/li&gt;
  &lt;li&gt;在后台启动ElasticSearch的详细过程，可以参考&lt;code&gt;bin/elasticsearch&lt;/code&gt;脚本细节，内部有详细说明，本质就是shell脚本中启动一个Java进程。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;index&quot;&gt;Index操作&lt;/h2&gt;

&lt;h3 id=&quot;section-1&quot;&gt;插入数据&lt;/h3&gt;

&lt;p&gt;如果指定的 &lt;code&gt;Index&lt;/code&gt;`Type&lt;code&gt; 不存在，则自动创建，下面为向&lt;/code&gt;Index&lt;code&gt;\&lt;/code&gt;Type` 插入数据的命令；&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -XPUT &#39;http://localhost:9200/test/test/1&#39; -d &#39;{ &quot;name&quot; : &quot;Ning Guo&quot;}&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;section-2&quot;&gt;查询数据&lt;/h3&gt;

&lt;p&gt;查询指定条件的数据，两个操作：&lt;code&gt;_count&lt;/code&gt;、&lt;code&gt;_search&lt;/code&gt;。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[ningg@localhost ~]$ curl -XGET http://localhost:9200/test/_count?pretty=true
{
  &quot;count&quot; : 1,
  &quot;_shards&quot; : {
	&quot;total&quot; : 5,
	&quot;successful&quot; : 5,
	&quot;failed&quot; : 0
  }
}
[ningg@localhost ~]$ 
[ningg@localhost ~]$ curl -XGET http://localhost:9200/test/_search?pretty=true
{
  &quot;took&quot; : 2,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
	&quot;total&quot; : 5,
	&quot;successful&quot; : 5,
	&quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
	&quot;total&quot; : 1,
	&quot;max_score&quot; : 1.0,
	&quot;hits&quot; : [ {
	  &quot;_index&quot; : &quot;test&quot;,
	  &quot;_type&quot; : &quot;test&quot;,
	  &quot;_id&quot; : &quot;1&quot;,
	  &quot;_score&quot; : 1.0,
	  &quot;_source&quot;:{ &quot;name&quot; : &quot;Ning Guo&quot;}
	} ]
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;其他查询：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;查询 ElasticSearch 下，所有的 Index ：
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;curl http://localhost:9200/_alias?pretty&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;curl http://localhost:9200/_stats/indexes?pretty&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;curl http://localhost:9200/_cat/indices?pretty&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;注：直接执行&lt;code&gt;_cat&lt;/code&gt;会显示提示信息；&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;查询 Index 下所有的 Type 以及 Type 详情：
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;curl http://localhost:9200/indexName/_mapping?pretty&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;查询 Index 的详情：
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;curl http://localhost:9200/indexName/_status?pretty&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;精确查询：避免对keyword的分词和对document中field的分词&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-3&quot;&gt;删除数据&lt;/h3&gt;

&lt;p&gt;如何删除一个Index、Type、Document。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -XDELETE http://localhost:9200/test?pretty
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;section-4&quot;&gt;监控&lt;/h2&gt;

&lt;p&gt;Elastic官网提供了一种方式Marvel，不过这种方式是付费的，我x，那能不能利用Ganglia监控呢？实际上，ElasticSearch是基于Java的，而JVM能够通过JMX方式向外停工监控数据，唯一的问题是：ElasticSearch在JVM中记录的运行状态数据吗？&lt;/p&gt;

&lt;h2 id=&quot;section-5&quot;&gt;常见问题&lt;/h2&gt;

&lt;h3 id=&quot;warn-too-many-open-files&quot;&gt;WARN: Too many open files&lt;/h3&gt;

&lt;p&gt;详细错误信息：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[2015-04-14 11:18:25,797][WARN ][indices.cluster          ] [Rune] [flume-2015-04-14][2] failed to start shard
org.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [flume-2015-04-14][2] failed recovery
	at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:185)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.elasticsearch.index.engine.EngineCreationFailureException: [flume-2015-04-14][2] failed to open reader on writer
	at org.elasticsearch.index.engine.internal.InternalEngine.start(InternalEngine.java:326)
	at org.elasticsearch.index.shard.service.InternalIndexShard.performRecoveryPrepareForTranslog(InternalIndexShard.java:732)
	at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:231)
	at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:132)
	... 3 more
Caused by: java.nio.file.FileSystemException: /home/storm/es/elasticsearch-1.4.4/data/elasticsearch/nodes/0/indices/flume-2015-04-14/2/index/_h3.cfe: Too many open files
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:91)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)
	at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)
	at java.nio.channels.FileChannel.open(FileChannel.java:287)
	at java.nio.channels.FileChannel.open(FileChannel.java:334)
	at org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)
	at org.apache.lucene.store.FileSwitchDirectory.openInput(FileSwitchDirectory.java:172)
	at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:80)
	at org.elasticsearch.index.store.DistributorDirectory.openInput(DistributorDirectory.java:130)
	at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:80)
	at org.elasticsearch.index.store.Store$StoreDirectory.openInput(Store.java:515)
	at org.apache.lucene.store.Directory.openChecksumInput(Directory.java:113)
	at org.apache.lucene.store.CompoundFileDirectory.readEntries(CompoundFileDirectory.java:166)
	at org.apache.lucene.store.CompoundFileDirectory.&amp;lt;init&amp;gt;(CompoundFileDirectory.java:106)
	at org.apache.lucene.index.SegmentReader.readFieldInfos(SegmentReader.java:274)
	at org.apache.lucene.index.SegmentReader.&amp;lt;init&amp;gt;(SegmentReader.java:107)
	at org.apache.lucene.index.ReadersAndUpdates.getReader(ReadersAndUpdates.java:145)
	at org.apache.lucene.index.ReadersAndUpdates.getReadOnlyClone(ReadersAndUpdates.java:239)
	at org.apache.lucene.index.StandardDirectoryReader.open(StandardDirectoryReader.java:104)
	at org.apache.lucene.index.IndexWriter.getReader(IndexWriter.java:422)
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:112)
	at org.apache.lucene.search.SearcherManager.&amp;lt;init&amp;gt;(SearcherManager.java:89)
	at org.elasticsearch.index.engine.internal.InternalEngine.buildSearchManager(InternalEngine.java:1569)
	at org.elasticsearch.index.engine.internal.InternalEngine.start(InternalEngine.java:313)
	... 6 more
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;解决办法：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;在当前Linux下，使用elasticsearch用户身份，执行&lt;code&gt;ulimt -Hn&lt;/code&gt;和&lt;code&gt;ulimit -Sn&lt;/code&gt;，查看当前用户，在当前shell环境下，允许打开文件的最大个数；&lt;/li&gt;
  &lt;li&gt;打开&lt;code&gt;/etc/security/limits.conf&lt;/code&gt;文件，在最后，添加如下两行内容：&lt;em&gt;（启动elasticsearch的用户为&lt;code&gt;elasticsearch&lt;/code&gt;）&lt;/em&gt;
    &lt;ul&gt;
      &lt;li&gt;elasticsearch soft  nofile 32000&lt;/li&gt;
      &lt;li&gt;elasticsearch hard  nofile 32000&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;重新以elasticsearch用户身份登录，并执行执行&lt;code&gt;ulimt -Hn&lt;/code&gt;和&lt;code&gt;ulimit -Sn&lt;/code&gt;，以此验证上述配置是否生效；若设置生效，则重启Elasticsearch即可。&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;简要解释：&lt;code&gt;/etc/security/limits.conf&lt;/code&gt;文件中设置了，一个用户或者组，所能使用的系统资源，例如：CPU、内存以及可同时打开文件的数量等。&lt;/p&gt;

&lt;p&gt;更多细节，参考：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://elasticsearch-users.115913.n3.nabble.com/Error-Too-many-open-files-td2779067.html&quot;&gt;Error - Too many open files&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://queirozf.com/entries/elasticsearch-too-many-open-files&quot;&gt;Elasticsearch - too many open files&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-6&quot;&gt;参考来源&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/elastic/elasticsearch&quot;&gt;ElasticSearch(Github)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.gitbook.com/book/looly/elasticsearch-the-definitive-guide-cn/details&quot;&gt;gitbook：Elasticsearch权威指南（中文版）&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://learnes.net/index.html&quot;&gt;gitbook：Elasticsearch 权威指南&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
   <entry>
     <title>Flume实现将Kafka中数据传入ElasticSearch中</title>
     <link href="http://ningg.github.com/flume-kafka-source-elasticsearch-sink"/>
     <updated>2015-03-11T00:00:00+08:00</updated>
     <id>http://ningg.github.com/flume-kafka-source-elasticsearch-sink</id>
     <content type="html">&lt;p&gt;目标：利用Flume Agent实现，将Kafka中数据取出，送入ElasticSearch中。&lt;/p&gt;

&lt;p&gt;分析：Flume Agent需要的工作，两点：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Flume Kafka Source：负责从Kafka中读取数据；&lt;/li&gt;
  &lt;li&gt;Flume ElasticSearch Sink：负责将数据送入ElasticSearch；&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;当前Flume 1.5.2已经包含了ElasticSearchSink，因此，需要定制实现Flume Kafka Source即可。当前从Jira上得知，Flume 1.6.0 中将包含Flume-ng-kafka-source，但是，当前Flume 1.6.0版本并没有发布，怎么办？两条路：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;github上别人开源的Flume-ng-kafka-source&lt;/li&gt;
  &lt;li&gt;flume 1.6.0分支的代码中flume-ng-kafka-source&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;初步选定Flume 1.6.0分支中的flume-ng-kafka-source部分，这部分代码已经包含在&lt;a href=&quot;https://github.com/ningg/flume-ng-extends-source&quot;&gt;flume-ng-extends-source&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;编译代码&lt;/h2&gt;

&lt;p&gt;执行命令：&lt;code&gt;mvn clean package&lt;/code&gt;得到jar包：&lt;code&gt;flume-ng-extends-source-x.x.x.jar&lt;/code&gt;。&lt;/p&gt;

&lt;h2 id=&quot;section-1&quot;&gt;安装插件&lt;/h2&gt;

&lt;p&gt;两类jar包：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;lib中jar包
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;flume-ng-extends-source-x.x.x.jar&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;libext中jar包
    &lt;ul&gt;
      &lt;li&gt;&lt;code&gt;kafka_2.9.2-0.8.2.0.jar&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;kafka-clients-0.8.2.0.jar&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;metrics-core-2.2.0.jar&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;scala-library-2.9.2.jar&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code&gt;zkclient-0.3.jar&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;疑问&lt;/strong&gt;：maven打包时，如何将当前jar包以及其依赖包都导出？
参考&lt;a href=&quot;https://github.com/thilinamb/flume-ng-kafka-sink&quot;&gt;thilinamb flume kafka sink&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-2&quot;&gt;配置&lt;/h2&gt;

&lt;p&gt;在properties文件中进行配置，配置样本文件：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Kafka Source For retrieve from Kafka cluster.
agent.sources.seqGenSrc.type = com.github.ningg.flume.source.KafkaSource
#agent.sources.seqGenSrc.batchSize = 2
agent.sources.seqGenSrc.batchDurationMillis = 1000
agent.sources.seqGenSrc.topic = good
agent.sources.seqGenSrc.zookeeperConnect = 168.7.2.164:2181,168.7.2.165:2181,168.7.2.166:2181
agent.sources.seqGenSrc.groupId = elasticsearch
#agent.sources.seqGenSrc.kafka.consumer.timeout.ms = 1000
#agent.sources.seqGenSrc.kafka.auto.commit.enable = false

# ElasticSearchSink for ElasticSearch.
agent.sinks.loggerSink.type = org.apache.flume.sink.elasticsearch.ElasticSearchSink
agent.sinks.loggerSink.indexName = flume
agent.sinks.loggerSink.indexType = log
agent.sinks.loggerSink.batchSize = 100
#agent.sinks.loggerSink.ttl = 5
agent.sinks.loggerSink.client = transport
agent.sinks.loggerSink.hostNames = 168.7.1.69:9300
#agent.sinks.loggerSink.client = rest
#agent.sinks.loggerSink.hostNames = 168.7.1.69:9200
#agent.sinks.loggerSink.serializer = org.apache.flume.sink.elasticsearch.ElasticSearchLogStashEventSerializer
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;section-3&quot;&gt;定制&lt;/h2&gt;

&lt;p&gt;目标：定制ElasticSearchSink的serializer。&lt;/p&gt;

&lt;p&gt;现象：设置ElasticSearchSink的参数&lt;code&gt;batchSize=1000&lt;/code&gt;后，当前ES中当天的Index中出现了&lt;code&gt;120,000&lt;/code&gt;+的记录，而此时，原有平台发现，当前产生的数据只有&lt;code&gt;20,000&lt;/code&gt;，因此，猜测KafkaSource将Kafka集群中指定topic下的所有数据都传入了ES中。&lt;/p&gt;

&lt;p&gt;几点：&lt;/p&gt;

&lt;p&gt;ElasticSearchSink中新的配置参数：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;indexNameBuilder=org.apache.flume.sink.elasticsearch.TimeBasedIndexNameBuilder
    &lt;ul&gt;
      &lt;li&gt;上述将以&lt;code&gt;indexPrefix&lt;/code&gt;-&lt;code&gt;yyyy-MM-dd&lt;/code&gt;方式，每天产生一个Index；&lt;/li&gt;
      &lt;li&gt;其他选项：org.apache.flume.sink.elasticsearch.SimpleIndexNameBuilder，其直接以设定的&lt;code&gt;indexPrefix&lt;/code&gt;（实际就是设置的&lt;code&gt;indexName&lt;/code&gt;）&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;dateFormat=&lt;code&gt;yyyy-MM-dd&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;timeZONE=&lt;code&gt;Etc/UTC&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;serializer=org.apache.flume.sink.elasticsearch.ElasticSearchLogStashEventSerializer
    &lt;ul&gt;
      &lt;li&gt;上述选项，将 flume event 的 Header 中 key-value 添加到一个新增的字段&lt;code&gt;@fields&lt;/code&gt;中；&lt;/li&gt;
      &lt;li&gt;其他选项：org.apache.flume.sink.elasticsearch.ElasticSearchDynamicSerializer，其直接将body、header构造为一个JSON字符串，添加到ElasticSearch中。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section-4&quot;&gt;重启&lt;/h2&gt;

&lt;p&gt;如果终止Flume Agent，然后重启。疑问：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Kafka中的数据，是否会重复发送到ElasticSearch？&lt;/li&gt;
  &lt;li&gt;Kafka中的数据，是否有遗漏，没有发送到ElasticSearch？&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;思考，几个情况：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Kafka对应的Consumer有offset&lt;/li&gt;
  &lt;li&gt;Kafka中数据，周期性的清理，例如默认3天&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;需要详细思考Flume Agent的重启场景。&lt;/p&gt;

</content>
   </entry>
   
   <entry>
     <title>ElasticSearch下配置Kafka插件</title>
     <link href="http://ningg.github.com/elasticsearch-kafka-plugin"/>
     <updated>2015-03-10T00:00:00+08:00</updated>
     <id>http://ningg.github.com/elasticsearch-kafka-plugin</id>
     <content type="html">&lt;p&gt;做个记录：ElasticSearch下如何添加、删除插件。做此记录的初衷有两个：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;记录，作为备忘；&lt;/li&gt;
  &lt;li&gt;记录初稿，今后操作时，方便基于此的改进和积累；&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;section&quot;&gt;组件版本&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;组件&lt;/th&gt;
      &lt;th&gt;版本&lt;/th&gt;
      &lt;th&gt;链接&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ElasticSearch&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.4.4&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;http://www.elasticsearch.org/&quot;&gt;参考链接&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Kafka&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;0.8.2.0&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;http://kafka.apache.org/&quot;&gt;参考链接&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ElasticSearch river kafka&lt;/td&gt;
      &lt;td&gt;&lt;code&gt;1.2.1&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/mariamhakobyan/elasticsearch-river-kafka&quot;&gt;参考链接&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;操作系统&lt;/td&gt;
      &lt;td&gt;centOS 6.3&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;备注：已经folk了插件&lt;a href=&quot;https://github.com/ningg/elasticsearch-river-kafka&quot;&gt;ElasticSearch river kafka&lt;/a&gt;，并将其中ElasticSearch、Kafka对应版本好进行升级，本地&lt;code&gt;mvn clean install&lt;/code&gt;编译之后，用于进行插件的安装。&lt;/p&gt;

&lt;p&gt;执行&lt;code&gt;mvn clean install&lt;/code&gt;命令时，提示：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$mvn clean insatll
...
[INFO] --- maven-failsafe-plugin:2.14:integration-test (default) @ elasticsearch-river-kafka ---
[INFO] No tests to run.
[WARNING] File encoding has not been set, using platform encoding GBK, i.e. build is platform dependent!
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：在&lt;code&gt;pom.xml&lt;/code&gt;中&lt;code&gt;failsafe&lt;/code&gt;插件下，设定编码方式，具体：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;plugin&amp;gt;
	&amp;lt;artifactId&amp;gt;maven-failsafe-plugin&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;${version.maven.failsafe.plugin}&amp;lt;/version&amp;gt;
	&amp;lt;configuration&amp;gt;
		&amp;lt;encoding&amp;gt;UTF-8&amp;lt;/encoding&amp;gt;
	&amp;lt;/configuration&amp;gt;
	&amp;lt;executions&amp;gt;
		&amp;lt;execution&amp;gt;
			&amp;lt;goals&amp;gt;
				&amp;lt;goal&amp;gt;integration-test&amp;lt;/goal&amp;gt;
				&amp;lt;goal&amp;gt;verify&amp;lt;/goal&amp;gt;
			&amp;lt;/goals&amp;gt;
		&amp;lt;/execution&amp;gt;
	&amp;lt;/executions&amp;gt;
&amp;lt;/plugin&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;section-1&quot;&gt;添加插件&lt;/h2&gt;

&lt;p&gt;目标：在ElasticSearch下添加Kafka插件。&lt;/p&gt;

&lt;p&gt;第一步：编译插件：&lt;code&gt;mvn clean install&lt;/code&gt;，得到&lt;code&gt;$PROJECT-PATH/target/elasticsearch-river-kafka-1.2.1-SNAPSHOT-plugin.zip&lt;/code&gt;文件。&lt;/p&gt;

&lt;p&gt;第二步：安装插件：将上述&lt;code&gt;elasticsearch-river-kafka-1.2.1-SNAPSHOT-plugin.zip&lt;/code&gt;文件上传到ElasticSearch运行的服务器上&lt;code&gt;/home/es&lt;/code&gt;目录下，执行下述命令，安装插件：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd $ELASTICSEARCH_HOME
.bin/plugin --install kafka-river --url file:////home/es/elasticsearch-river-kafka-1.2.1-SNAPSHOT-plugin.zip
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;第三步：配置Kafka插件，详细配置参数，参考&lt;a href=&quot;https://github.com/mariamhakobyan/elasticsearch-river-kafka&quot;&gt;ElasticSearch river kafka&lt;/a&gt;，下面只贴一下我自己的配置：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -XPUT &#39;http://168.7.1.69:9200/_river/kafka-river/_meta&#39; -d &#39;
{  
  &quot;type&quot;:&quot;kafka&quot;,
  &quot;kafka&quot;:{
	 &quot;zookeeper.connect&quot;:&quot;168.7.2.164:2181,168.7.2.165:2181,168.7.2.166:2181&quot;,
	 &quot;zookeeper.connection.timeout.ms&quot;:10000,
	 &quot;topic&quot;:&quot;good&quot;,
	 &quot;message.type&quot;: &quot;json&quot;
  },
  &quot;index&quot;:{
	 &quot;index&quot;:&quot;kafka-index&quot;,
	 &quot;type&quot;:&quot;status&quot;,
	 &quot;bulk.size&quot;:100,
	 &quot;concurrent.requests&quot;:1,
	 &quot;action.type&quot;:&quot;index&quot;
  }
}&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;第四步：重新启动ElasticSearch&lt;/p&gt;

&lt;p&gt;第五步：查询Kafka数据是否已经传送至ElasticSearch，执行命令如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -XGET &#39;http://168.7.1.69:9200/kafka-index/status/_search?pretty&#39;
// 或者 统计记录条数
curl -XGET &#39;http://168.7.1.69:9200/kafka-index/status/_count?pretty&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;注：参考自&lt;a href=&quot;https://github.com/mariamhakobyan/elasticsearch-river-kafka&quot;&gt;ElasticSearch river kafka&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-2&quot;&gt;删除插件&lt;/h2&gt;

&lt;p&gt;第一步，通过rest接口，删除，执行命令：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -XDELETE &#39;http://168.7.1.69:9200/_river/kafka-river/&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;第二步，通过plugin命令删除，具体执行命令：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd $ELASTICSEARCH_HOME
.bin/plugin --remove kafka-river
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;第三步，重启ElasticSearch。&lt;/p&gt;

&lt;p&gt;注：参考自&lt;a href=&quot;https://github.com/mariamhakobyan/elasticsearch-river-kafka&quot;&gt;ElasticSearch river kafka&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;section-3&quot;&gt;参考来源&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/mariamhakobyan/elasticsearch-river-kafka&quot;&gt;ElasticSearch river kafka&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
   </entry>
   
 
</feed>
