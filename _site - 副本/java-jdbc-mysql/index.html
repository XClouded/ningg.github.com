<!DOCTYPE html>
<html xmlns:wb="http://open.weibo.com/wb">
<head>
    <!--   Author: NingG   -->
    <meta charset="utf-8" />
	<meta property="wb:webmaster" content="7ea7f3d5f3edad6a" />
    <title>JDBC，Statement、PreparedStatement | ningg.top</title>
    <meta name="author" content="NingG" />
    <meta name="renderer" content="webkit">
    <meta name="description" content=" Java操作数据库基本过程，Statement、PreparedStatement之间差异  " />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

    <link rel="stylesheet" href="/css/default.css" type="text/css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="" />
	
    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>
	<script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
	
    <div class="home-menu">
        <div class="home-icon-con">
            <a class="home-menu-icon" href="/">NingG</a>
            <a class="home-follow" href="#" title="Contact Me">+</a>
        </div>
        <div class="home-contact">
            <a href="http://weibo.com/ggningg/" target="_blank" style="margin-left:-5px;"><img src="http://www.weibo.com/favicon.ico" alt="" width="25"/></a>
            <a href="http://www.douban.com/people/ggningg/" target="_blank" style="text-align:center;"><img src="http://www.douban.com/favicon.ico" alt="" width="22"/></a>
			<a href="http://github.com/ningg" alt="" target="_blank" style="text-align:right;"><img src="/images/icon-cube-smaller.png" width="22"/></a>
        </div>
    </div>

    <link rel="stylesheet" href="/js/prettify/prettify.css" />
<style type="text/css">
    body { background:#e8e8e8; }
    @media screen and (max-width: 750px){
        body { background:#fff; }
    }
    @media screen and (max-width: 1020px){
        body { background:#fff; }
    }
</style>

<div id="content">
    <div class="entry">
        <h1 class="entry-title"><a href="/java-jdbc-mysql" title="JDBC，Statement、PreparedStatement">JDBC，Statement、PreparedStatement</a></h1>
        <p class="entry-date">2012-05-24</p>
        <p>几点：</p>

<ul>
  <li>JDBC是什么？</li>
  <li>Java操作MySQL数据库的基本过程</li>
  <li>Statement、PrepearedStatement之间比较</li>
</ul>

<p>todo：</p>

<ul>
  <li>数据库连接池；</li>
  <li>Spring对JDBC的支持；</li>
</ul>

<p>todo 参考：</p>

<ul>
  <li><a href="http://sharryjava.iteye.com/category/55314">数据库系列</a></li>
</ul>

<h2 id="jdbc">JDBC</h2>

<p>JDBC(Java Database Connectivity)，Java 数据库连接API，本质是Sun公司定义的一套接口规范，即，通过调用哪些确定的方法即可实现对数据库的操作。JDBC产生的原因很简单：</p>

<ul>
  <li>不同的数据库，原理之间有差异，操作命令也有差异；</li>
  <li>如果针对不同的数据库，编写的Java代码也不同，这样Java代码可移植性很差；</li>
  <li>Java语言设计者，希望通过相同的Java代码操作不同的数据库，增强程序通用性；</li>
  <li>Java语言设计者，设定了一套标准的数据库操作API，JDBC API；</li>
  <li>各个数据库厂商，根据自身特点，提供JDBC Driver的具体实现；
    <ul>
      <li>MySQL，官网提供了<a href="http://www.mysql.com/products/connector/">JDBC Driver for MySQL</a></li>
      <li>SQL Server，官网提供了<a href="https://msdn.microsoft.com/zh-cn/data/aa937724.aspx">JDBC Driver for SQL Server</a></li>
    </ul>
  </li>
</ul>

<p>Tips：</p>

<blockquote>
  <p>JDBC就是Java操作数据库的API，是Java标准类库的扩展，目的：JDBC开发的java程序能够跨平台运行，不受数据库的限制。</p>
</blockquote>

<h2 id="jdbc-1">JDBC实现原理</h2>

<p>JDBC由 3 部分实现：</p>

<ul>
  <li>JDBC API: 应用程序对JDBC Driver Manager之间的接口；</li>
  <li>JDBC Driver Manager：管理不同的JDBC Driver；</li>
  <li>JDBC Driver API: JDBC Driver Manager对JDBC Driver之间接口；</li>
</ul>

<p>此外，不同数据库厂商，根据自身特点，提供具体JDBC Driver的实现，这一JDBC Driver满足JDBC Driver API即可。这样JDBC Driver就可以注册到JDBC Driver Manager了。</p>

<p>JDBC Driver Manager可确保使用正确的JDBC Driver来访问每个数据源。JDBC Driver Manager能够支持连接到多个异构数据库的多个并发的JDBC Driver。<strong>Java应用程序中，只需要调用JDBC API就可以实现对异构数据库的访问，每次切换数据库时，只需要改变JDBC Driver Manager加载的JDBC Driver名称即可，不需要修改Java代码</strong>。</p>

<p><img src="/images/java-jdbc-mysql/jdbc-framework.png" alt="" /></p>

<p>另外，ODBC是Microsoft为C语言访问数据库提供的一套编程接口。如果数据库供应商只提供了ODBC驱动器。那么可以通过JDBC-ODBC桥来进行连接。</p>

<h2 id="java">Java操作数据库的基本过程</h2>

<p>Java操作MySQL数据库的基本过程：</p>

<ul>
  <li>连接到数据库</li>
  <li>创建SQL语句</li>
  <li>执行SQL语句</li>
  <li>查看SQL执行结果</li>
  <li>关闭连接</li>
</ul>

<h3 id="jdbc-driver-jar">添加依赖的JDBC Driver jar包</h3>

<p>直接从<a href="http://www.mysql.com/products/connector/">JDBC Driver for MySQL</a>中下载安装程序，或者从<a href="http://repo1.maven.org/maven2/mysql/mysql-connector-java/">Maven中央仓库</a> 中下载mysql-connector-java-5.1.34.jar，并将此jar包添加到 Build Path 中。</p>

<p>如果使用Maven管理工程，则在pom.xml中添加如下依赖：</p>

<pre><code>&lt;dependency&gt;
	&lt;groupId&gt;mysql&lt;/groupId&gt;
	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
	&lt;version&gt;5.1.34&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h3 id="section">编写示例代码</h3>

<p>按照上述 5 个步骤，创建连接、编写SQL、执行、处理结果、释放连接，具体示例代码如下：</p>

<pre><code>package test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;
import java.sql.ResultSet;


public class TestJDBC {
	
	public static void main(String[] args) {
		Connection conn = null;
		Statement st = null;
		ResultSet rs = null;
		String driverClassName = "com.mysql.jdbc.Driver";
		String url = "jdbc:mysql://168.7.2.167:3306/studentmgr";
		String username = "root";
		String password = "root";
		
		try{
			Class.forName(driverClassName);	// 加载JDBC Driver
			conn = DriverManager.getConnection(url, username, password);// 建立连接
			
			st = conn.createStatement();// 创建SQL
			String sql = "SELECT * FROM STUDENT";
			rs = st.executeQuery(sql);// 执行SQL
			
			while (rs.next()) {	// 处理结果
				System.out.println(rs.getString("name"));
			}
		} catch(Exception exp){
			exp.printStackTrace();
		} finally {
			
			try {
				if (rs != null) {
					rs.close();
				}
				
				if(st != null){
					st.close();
				}
				
				if(conn != null){
					conn.close();
				}
			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}
}
</code></pre>

<p>Tips：</p>

<blockquote>
  <p>上述操作涉及的DriverManager、Connection、Statement、ResultSet，都是<code>java.sql.*</code>。</p>
</blockquote>

<h2 id="statementpreparedstatement">Statement、PreparedStatement之间差异</h2>

<p>Statement的用法：</p>

<pre><code>Statement st = con.createStatement();
String query = "INSERT INTO Testing(Id) VALUES(" + 2 + ")";	// 拼接SQL
st.executeUpdate(query);
</code></pre>

<p>PreapredStatement的用法：</p>

<pre><code>PreparedStatement pst = con.prepareStatement("INSERT INTO Authors(Name) VALUES(?)");
pst.setString(1, author);
pst.executeUpdate();
</code></pre>

<p>总结一下两者之间的差异：</p>

<ul>
  <li>PreparedStatement，通过set方法设置执行的SQL，代码可读性和可维护性好；</li>
  <li>PreparedStatement，可防止SQL注入攻击；</li>
  <li>预编译，性能好；</li>
</ul>

<h2 id="section-1">参考来源</h2>

<ul>
  <li><a href="http://blog.csdn.net/luanlouis/article/category/2158459">JDBC原理解析</a> <em>(系列)</em></li>
  <li><a href="http://www.mysql.com/products/connector/">JDBC Driver for MySQL</a></li>
  <li><a href="https://msdn.microsoft.com/zh-cn/data/aa937724.aspx">JDBC Driver for SQL Server</a></li>
  <li><a href="http://www.yiibai.com/jdbc/jdbc-introduction.html">JDBC4简介，JDBC是什么？</a></li>
  <li><a href="http://yde986.iteye.com/blog/900373">什么是JDBC</a></li>
  <li><a href="http://sharryjava.iteye.com/blog/325872">jdbc编程基础（一）——jdbc是什么</a></li>
  <li><a href="http://it.deepinmind.com/jdbc/2014/03/18/JDBC%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%86%E9%94%A6%28%E4%B8%80%29.html">JDBC常见面试题集锦(一)</a></li>
  <li><a href="http://www.ntu.edu.sg/home/ehchua/programming/java/JDBC_Basic.html#zz-3.1">An Introduction to Java Database (JDBC) Programming</a></li>
  <li><a href="http://www.importnew.com/5006.html">JDBC为什么要使用PreparedStatement而不是Statement</a></li>
</ul>



        <div id="disqus_container">
            <div style="margin-bottom:20px" class="right">
				<wb:share-button appkey="2306590132" addition="simple" type="button" ralateUid="2356527183"></wb:share-button>
            </div>
            <!--<a href="#" class="comment" onclick="return false;">点击查看评论</a>-->
            <div id="disqus_thread"></div>
        </div>
    </div>

	
    <div class="sidenav">
		<iframe width="100%" height="75" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=2356527183&verifier=1ccfb61e&colors=d6f3f7,ffffff,666666,0082cb,ecfbfd&dpc=1"></iframe>
    </div>

</div>

<script src="/js/post.js" type="text/javascript"></script>


	<div id="gotoTop">Top</div>


    <!--*********************************************************-->
    <!--****** 宝贝儿，看见这个时候，删掉下面的统计代码哦~ ******-->
    <!--*********************************************************-->
	<script>
	  (function(i,s,o,g,r,a,m){
		  i['GoogleAnalyticsObject']=r;i[r]=i[r] || function(){
			(i[r].q=i[r].q||[]).push(arguments)}, i[r].l=1*new Date();
			a=s.createElement(o), m=s.getElementsByTagName(o)[0];
			a.async=1;
			a.src=g;
			m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-48535193-1', 'ningg.github.io');
	  ga('send', 'pageview');
	</script>
    
	
    <script type="text/javascript">
		function gotoTop(min_height){
			$("#gotoTop").click(
				function(){$('html,body').animate({scrollTop:0},700);
			}).hover(
				function(){$(this).addClass("hover");},
				function(){$(this).removeClass("hover");
			});
			min_height ? min_height = min_height : min_height = 600;
			$(window).scroll(function(){
				
				var s = $(window).scrollTop();
				
				if( s > min_height){
					$("#gotoTop").fadeIn(100);
				}else{
					$("#gotoTop").fadeOut(200);
				};
			});
		};
		gotoTop();

        $(function(){
            $('.home-follow').click(function(e){
                e.preventDefault();

                if($('.home-contact').is(':visible')){
                    $('.home-contact').slideUp(100);
                }else{
                    $('.home-contact').slideDown(100);
                }
            });
        })

    </script>
</body>
</html>
